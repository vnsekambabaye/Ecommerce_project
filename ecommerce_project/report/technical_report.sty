\documentclass[11pt]{article}
\usepackage{geometry}
\geometry{a4paper, margin=1in}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{hyperref}
\usepackage{parskip}
\usepackage{enumitem}
\usepackage{xcolor}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{listings}
\usepackage{url}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{placeins} % For controlling float placement

% Define listing style for file structure
\lstset{
  basicstyle=\ttfamily\small,
  breaklines=true,
  frame=single,
  numbers=none,
  tabsize=2,
  captionpos=b
}

\begin{document}

% Custom title with logo and text on the same page
\begin{center}
  \includegraphics[width=0.5\textwidth]{results/logo_with_golden_frame.png} % Logo with increased width
  \vspace{15pt} % Consistent space between logo and title
  {\Large \textbf{E-Commerce Big Data Analytics: MongoDB, HBase, and Spark Integration}} \\
  \vspace{15pt} % Consistent space before author and date
  \large Vincent NSEKAMBABAYE \\
  \normalsize June 8, 2025, 05:47 PM CAT % Updated to current date and time
\end{center}
\vspace{15pt} % Consistent space before abstract

\begin{abstract}
This report presents a big data analytics pipeline for an e-commerce dataset, leveraging MongoDB, HBase, and Apache Spark. We design schemas for document and wide-column stores, process data with distributed computing, integrate analytics across systems, and visualize insights. The solution demonstrates scalability and actionable business insights, fulfilling a university assignment to model, process, and analyze e-commerce data.
\end{abstract}

\section{Introduction}
This project develops a big data analytics pipeline for an e-commerce dataset comprising 10,000 user profiles, 5,000 products, 25 categories, 2 million sessions, and 500,000 transactions. The objectives are to:
\begin{itemize}
  \item Design efficient data models for MongoDB and HBase.
  \item Process large-scale data using Apache Spark.
  \item Integrate analytics for insights like Customer Lifetime Value (CLV).
  \item Visualize findings to support business decisions.
\end{itemize}
The deliverables include a GitHub repository with source code, sample queries, and this 6--8 page report detailing architecture, modeling, processing, analytics, visualizations, and scalability.

\section{System Architecture}
The architecture integrates:
\begin{itemize}
  \item \textbf{MongoDB}: Stores user profiles, products, categories, sessions, and transactions in a document model.
  \item \textbf{HBase}: Manages time-series session and product performance data in a wide-column store.
  \item \textbf{Apache Spark}: Processes data for analytics and joins MongoDB and HBase outputs.
\end{itemize}
Data flows from JSON files generated by \texttt{data\_generator.py} to MongoDB and HBase. Spark reads, processes, and outputs results (CSV, plots). Visualizations use Python libraries.

\section{Data Modeling Decisions}
\subsection{MongoDB Schema}
Collections include:
\begin{itemize}
  \item \texttt{users}: \texttt{user\_id}, \texttt{geo\_data}, \texttt{registration\_date}. Index: \texttt{user\_id}.
  \item \texttt{products}: \texttt{product\_id}, \texttt{category\_id}, \texttt{base\_price}, \texttt{price\_history}. Indexes: \texttt{product\_id}, \texttt{category\_id}.
  \item \texttt{categories}: \texttt{category\_id}, \texttt{subcategories}. Index: \texttt{category\_id}.
  \item \texttt{sessions}: \texttt{session\_id}, \texttt{user\_id}, \texttt{page\_views}. Indexes: \texttt{session\_id}, \texttt{user\_id}.
  \item \texttt{transactions}: \texttt{transaction\_id}, \texttt{user\_id}, \texttt{items}, \texttt{total}. Indexes: \texttt{transaction\_id}, \texttt{user\_id}.
\end{itemize}
\textbf{Rationale}: Document model supports nested arrays (e.g., \texttt{items}) and aggregations for top products.

\subsection{HBase Schema}
Tables include:
\begin{itemize}
  \item \texttt{user\_sessions}: Row key: \texttt{user\_id:reverse\_timestamp}. Columns: \texttt{info:duration}, \texttt{views:data}.
  \item \texttt{product\_metrics}: Row key: \texttt{product\_id:date}. Columns: \texttt{views:count}, \texttt{purchases:quantity}.
\end{itemize}
\textbf{Rationale}: Optimized for time-series queries (e.g., recent user sessions).

\section{Spark Processing Pipelines}
\texttt{spark\_processing.py} computes co-purchase recommendations:
\begin{enumerate}
  \item Loads \texttt{transactions.json} into DataFrames.
  \item Cleans missing \texttt{discount} values.
  \item Groups \texttt{items} by \texttt{transaction\_id}, generates product pairs, and counts co-purchases.
  \item Outputs to \texttt{co\_purchase\_recommendations.csv}.
\end{enumerate}
Optimizations include caching and limiting output.

\section{Integrated Analytics Workflows}
\texttt{data\_integration.py} calculates CLV:
\begin{enumerate}
  \item MongoDB: Retrieves \texttt{users} (\texttt{registration\_date}) and \texttt{transactions} (\texttt{total}).
  \item HBase: Scans \texttt{user\_sessions} for \texttt{duration}.
  \item Spark: Joins on \texttt{user\_id}, computes \texttt{CLV = total\_spending * (sessions\_per\_month + avg\_duration)}.
  \item Outputs to \texttt{clv\_results.csv}.
\end{enumerate}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{results/Top10_customers_by_Estimated_CLV.png}
  \caption{Top 10 Customers by Estimated CLV}
  \label{fig:top_10_customers_by_clv}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{results/Top10_States_by_revenue.png}
  \caption{Top 10 States by Revenue}
  \label{fig:top_10_states_by_revenue}
\end{figure}

\section{Technology Selection Justification}
\begin{itemize}
  \item \textbf{MongoDB}: Flexible for nested documents and aggregations.
  \item \textbf{HBase}: Efficient for time-series session data.
  \item \textbf{Spark}: Scalable for large-scale joins and analytics.
\end{itemize}

\section{Scalability Considerations}
\begin{itemize}
  \item \textbf{MongoDB}: Sharding on \texttt{user\_id}.
  \item \textbf{HBase}: Region splitting, row key design.
  \item \textbf{Spark}: Cluster partitioning.
\end{itemize}

\section{Methodology for Key Analyses}
\begin{itemize}
  \item \textbf{Top Products}: Aggregates \texttt{items.quantity} in MongoDB.
  \item \textbf{User Segmentation}: Buckets \texttt{transaction} counts.
  \item \textbf{CLV}: Joins MongoDB and HBase data in Spark, weights engagement.
\end{itemize}

\section{Key Findings and Business Insights}
\begin{itemize}
  \item Top products drive revenue, guiding inventory.
  \item Most users are occasional buyers, suggesting targeted campaigns.
  \item High-CLV users are engaged, supporting loyalty programs.
\end{itemize}

\section{Visualization of Results}
\FloatBarrier
Visualizations include:
\begin{itemize}
  \item Sales performance by categories (Figure~\ref{fig:sales_trend}).
  \item Top products by revenue (Figure~\ref{fig:top_products}).
  \item Customer segmentation by month (Figure~\ref{fig:user_segmentation}).
  \item Top counties by user and average spending (Figure~\ref{fig:counties_by_user}).
  \item Top customers by spending (Figure~\ref{fig:customers_by_spending}).
\end{itemize}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{results/Sales_performance_by_categories.png}
  \caption{Sales Performance by Categories}
  \label{fig:sales_trend}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{results/Top10_product_by_revenue.png}
  \caption{Top 10 Products by Revenue}
  \label{fig:top_products}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{results/Custommer_segmentation_by_month.png}
  \caption{Customer Segmentation by Month}
  \label{fig:user_segmentation}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{results/Top10_counties_by_user_and_average_spending.png}
  \caption{Top 10 Counties by User and Average Spending}
  \label{fig:counties_by_user}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{results/Top10_customers_by_spending.png}
  \caption{Top 10 Customers by Spending}
  \label{fig:customers_by_spending}
\end{figure}
\FloatBarrier

\section{Limitations and Future Work}
\begin{itemize}
  \item \textbf{Limitations}: No \texttt{subcategory\_id} in \texttt{products.json}, static visualizations.
  \item \textbf{Future Work}: Add \texttt{subcategory\_id}, use interactive dashboards, implement real-time analytics.
\end{itemize}

\section{Project Structure}
\FloatBarrier
\subsection{Directory Structure}
\begin{lstlisting}
ecommerce-analytics/
├── data/ecommerce_data/
│   ├── users.json
│   ├── products.json
│   ├── categories.json
│   ├── transactions.json
│   ├── sessions_0.json
│   ├── sessions_1.json
│   └── ...
├── scripts/
│   ├── data_generator.py
│   ├── mongodb_setup.py
│   ├── hbase_setup.py
│   ├── spark_processing.py
│   ├── visualizations.py
│   ├── data_integration.py
│   └── generate_readme.py
├── results/
│   ├── co_purchase_recommendations.csv
│   ├── clv_results.csv
│   ├── Sales_performance_by_categories.png
│   ├── Top10_product_by_revenue.png
│   ├── Custommer_segmentation_by_month.png
│   ├── Top10_counties_by_user_and_average_spending.png
│   ├── Top10_customers_by_spending.png
│   ├── Top10_customers_by_Estimated_CLV.png
│   └── Top10_States_by_revenue.png
├── docs/
│   ├── technical_report.tex
│   ├── technical_report.pdf
│   └── references.bib
├── .gitignore
├── README.md
├── requirements.txt
└── docker-compose.yml
\end{lstlisting}

\subsection{File Descriptions}
\begin{itemize}
  \item \textbf{data/ecommerce\_data/}: JSON files (10,000 users, 2M sessions). Sample included for submission.
  \item \textbf{scripts/}: Python scripts for generation, modeling, processing, and visualization.
  \item \textbf{results/}: CSV outputs and PNG plots.
  \item \textbf{docs/}: LaTeX report and bibliography.
  \item \textbf{Root}: Configuration files (\texttt{.gitignore}, \texttt{requirements.txt}).
\end{itemize}

\section{Conclusion}
The project delivers a scalable e-commerce analytics pipeline with actionable insights.

\bibliographystyle{plain}
\bibliography{references}

\end{document}